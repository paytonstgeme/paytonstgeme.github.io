<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Posts · Payton St Geme</title>
  <link rel="stylesheet" href="assets/style.css" />
</head>
<body>
  <!-- Shared header placeholder -->
  <header class="header" id="site-header"></header>

  <!-- Main content -->
  <main class="container posts-list">
    <h1>Posts</h1>
    <ul class="list" id="posts-list">
  <script>
    fetch('/posts_index.json')
      .then(r => r.json())
      .then(posts => {
        const list = document.getElementById('posts-list');
        list.innerHTML = ''; // clear placeholder
        posts.forEach(p => {
          const li = document.createElement('li');
          li.className = 'item';
          li.innerHTML = `
            <a class="item-title" href="${p.url}">${p.title}</a>
            <p class="item-desc">${p.desc || ''}</p>
            <time class="item-date" datetime="${p.date}">${formatDate(p.date)}</time>
          `;
          list.appendChild(li);
        });
      });

    function formatDate(iso) {
      if (!iso) return '';
      const d = new Date(iso);
      const months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
      return `${months[d.getMonth()]} ${d.getDate()}, ${d.getFullYear()}`;
    }
  </script>
</ul>
  </main>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <p>© <span id="year"></span> Payton St Geme</p>
    </div>
  </footer>

  <!-- Scripts -->
  <script>
    // Footer year
    const y = document.getElementById('year');
    if (y) y.textContent = new Date().getFullYear();

    // Load shared header, set active link, wire sidebar menu
    fetch("header.html")
      .then(r => r.text())
      .then(html => {
        const host = document.getElementById("site-header");
        host.innerHTML = html;

        // --- Active nav (treat page + any /posts/... as Posts) ---
        const file = location.pathname.split("/").pop() || "index.html";
        const isHome  = file === "index.html";
        const isPosts = file === "posts.html" || location.pathname.includes("/posts/");
        const isViews = file === "views.html";

        host.querySelectorAll(".nav-link").forEach(a => a.classList.remove("active"));
        if (isHome)  host.querySelector('.nav a[href="index.html"]')?.classList.add("active");
        if (isPosts) host.querySelector('.nav a[href="posts.html"]')?.classList.add("active");
        if (isViews) host.querySelector('.nav a[href="views.html"]')?.classList.add("active");

        // --- Sidebar menu wiring (adds/removes body.menu-open) ---
        const btn = host.querySelector(".menu-button");
        const sidebar = host.querySelector(".sidebar");
        const backdrop = host.querySelector(".backdrop");

        function openMenu() {
          sidebar?.classList.add("open");
          document.body.classList.add("menu-open");   // <-- shifts brand via CSS
          btn?.setAttribute("aria-expanded","true");
          sidebar?.setAttribute("aria-hidden","false");
          if (backdrop) backdrop.hidden = false;
        }
        function closeMenu() {
          sidebar?.classList.remove("open");
          document.body.classList.remove("menu-open"); // <-- resets brand
          btn?.setAttribute("aria-expanded","false");
          sidebar?.setAttribute("aria-hidden","true");
          if (backdrop) backdrop.hidden = true;
        }

        btn?.addEventListener("click", () =>
          sidebar?.classList.contains("open") ? closeMenu() : openMenu()
        );
        backdrop?.addEventListener("click", closeMenu);
        document.addEventListener("keydown", e => { if (e.key === "Escape") closeMenu(); });
      });
  </script>
</body>
</html>
